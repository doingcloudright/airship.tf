(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{177:function(e,s,r){"use strict";r.r(s);var t=r(18),a=Object(t.a)({},function(){var e=this,s=e.$createElement,r=e._self._c||s;return r("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[r("h1",{attrs:{id:"service-discovery"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#service-discovery","aria-hidden":"true"}},[e._v("#")]),e._v(" Service Discovery")]),e._v(" "),r("p",[e._v("Please read "),r("a",{attrs:{href:"https://aws.amazon.com/blogs/aws/amazon-ecs-service-discovery/",target:"_blank",rel:"noopener noreferrer"}},[e._v("this"),r("OutboundLink")],1),e._v(" article, on how Service Discovery can work for you.")]),e._v(" "),r("p",[r("code",[e._v("aws_service_discovery_private_dns_namespace")]),e._v(" creates the private dns namespace and route53 zone needed needed for the ECS Services to register to.")]),e._v(" "),r("div",{staticClass:"language-json extra-class"},[r("pre",{pre:!0,attrs:{class:"language-json"}},[r("code",[e._v("resource "),r("span",{pre:!0,attrs:{class:"token string"}},[e._v('"aws_service_discovery_private_dns_namespace"')]),e._v(" "),r("span",{pre:!0,attrs:{class:"token string"}},[e._v('"namespace"')]),e._v(" "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  name        = "),r("span",{pre:!0,attrs:{class:"token string"}},[e._v('"namespace.local"')]),e._v("\n  description = "),r("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Description"')]),e._v("\n  vpc         = "),r("span",{pre:!0,attrs:{class:"token string"}},[e._v('"${module.vpc.vpc_id}"')]),e._v("\n"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])]),r("br"),e._v(" "),r("br"),e._v(" "),r("br"),e._v(" "),r("p",[e._v("The ECS Module has only implemented Service discovery for non-public namespaces. Only for AWSVPC networked ECS Services the "),r("code",[e._v("dns_type")]),e._v(" A can be used, for bridge mode "),r("code",[e._v("SRV")]),e._v(".")]),e._v(" "),r("br"),e._v(" "),r("br"),e._v(" "),r("br"),e._v(" "),r("div",{staticClass:"warning custom-block"},[r("p",{staticClass:"custom-block-title"},[e._v("WARNING")]),e._v(" "),r("p",[e._v("Apply Terraform first with the "),r("code",[e._v("aws_service_discovery_private_dns_namespace")]),e._v(" resource before continuing.")])]),e._v(" "),r("br"),e._v(" "),r("div",{staticClass:"language-json extra-class"},[r("pre",{pre:!0,attrs:{class:"language-json"}},[r("code",[e._v("module "),r("span",{pre:!0,attrs:{class:"token string"}},[e._v('"demo_web"')]),e._v(" "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  ..\n  service_discovery_enabled = "),r("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("true")]),e._v("\n\n  service_discovery_properties_namespace_id                         = "),r("span",{pre:!0,attrs:{class:"token string"}},[e._v('"${aws_service_discovery_private_dns_namespace.namespace.id}"')]),e._v("\n  service_discovery_properties_dns_ttl                              = "),r("span",{pre:!0,attrs:{class:"token string"}},[e._v('"60"')]),e._v("\n  service_discovery_properties_dns_type                             = "),r("span",{pre:!0,attrs:{class:"token string"}},[e._v('"A"')]),e._v("\n  service_discovery_properties_routing_policy                       = "),r("span",{pre:!0,attrs:{class:"token string"}},[e._v('"MULTIVALUE"')]),e._v("\n  service_discovery_properties_healthcheck_custom_failure_threshold = "),r("span",{pre:!0,attrs:{class:"token string"}},[e._v('"1"')]),e._v("\n  ..\n"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])])])},[],!1,null,null,null);a.options.__file="service_discovery.md";s.default=a.exports}}]);