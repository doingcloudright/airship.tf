(window.webpackJsonp=window.webpackJsonp||[]).push([[42],{160:function(e,s,t){"use strict";t.r(s);var a=t(18),r=Object(a.a)({},function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"service-discovery"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#service-discovery","aria-hidden":"true"}},[e._v("#")]),e._v(" Service Discovery")]),e._v(" "),t("p",[e._v("Please read "),t("a",{attrs:{href:"https://aws.amazon.com/blogs/aws/amazon-ecs-service-discovery/",target:"_blank",rel:"noopener noreferrer"}},[e._v("this"),t("OutboundLink")],1),e._v(" article, on how Service Discovery can work for you.")]),e._v(" "),t("p",[t("code",[e._v("aws_service_discovery_private_dns_namespace")]),e._v(" creates the private dns namespace and route53 zone needed needed for the ECS Services to register to.")]),e._v(" "),t("div",{staticClass:"language-json extra-class"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[e._v("resource "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"aws_service_discovery_private_dns_namespace"')]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"namespace"')]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  name        = "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"namespace.local"')]),e._v("\n  description = "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"Description"')]),e._v("\n  vpc         = "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"${module.vpc.vpc_id}"')]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])]),t("br"),e._v(" "),t("br"),e._v(" "),t("br"),e._v(" "),t("p",[e._v("The ECS Module has only implemented Service discovery for non-public namespaces. Only for AWSVPC networked ECS Services the "),t("code",[e._v("dns_type")]),e._v(" A can be used, for bridge mode "),t("code",[e._v("SRV")]),e._v(".")]),e._v(" "),t("br"),e._v(" "),t("br"),e._v(" "),t("br"),e._v(" "),t("div",{staticClass:"warning custom-block"},[t("p",{staticClass:"custom-block-title"},[e._v("WARNING")]),e._v(" "),t("p",[e._v("Apply Terraform first with the "),t("code",[e._v("aws_service_discovery_private_dns_namespace")]),e._v(" resource before continuing.")])]),e._v(" "),t("br"),e._v(" "),t("div",{staticClass:"language-json extra-class"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[e._v("module "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"demo_web"')]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  ..\n  service_discovery_enabled = "),t("span",{pre:!0,attrs:{class:"token boolean"}},[e._v("true")]),e._v("\n\n  service_discovery_properties "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    namespace_id                         = "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"${aws_service_discovery_private_dns_namespace.namespace.id}"')]),e._v("\n    dns_ttl                              = "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"60"')]),e._v("\n    dns_type                             = "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"A"')]),e._v("\n    routing_policy                       = "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"MULTIVALUE"')]),e._v("\n    healthcheck_custom_failure_threshold = "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"1"')]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n  ..\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])])])},[],!1,null,null,null);r.options.__file="service_discovery.md";s.default=r.exports}}]);